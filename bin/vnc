#!/usr/bin/perl
use strict;
use warnings;

my $host = shift() or die "Usage: $0 <host>\n";

my $port = '5900';

my @server = qw(
  x11vnc
  -safer -localhost -nopw -once
  -display :0
);
my @client = qw(
  vncviewer
  localhost:0
  -quality 0
  -compresslevel 1
);

my @ssh = ("ssh", "-f",
  "-L", "$port:localhost:$port",
  $host
);

system @ssh, "@server";
exit $? if $? != 0;

sleep 5;

system @client;
