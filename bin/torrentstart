#!/usr/bin/perl
use strict;
use warnings;

my $path = shift;
my $dir;
my $base;
if(defined $path){
  ###handle symlinks
  $path =~ s/"/\\"/g;
  
  $dir = `dirname "$path"`;
  chomp $dir;
  $dir =~ s/"/\\"/g;
  $base = `basename "$path"`;
  chomp $base;
  $base =~ s/"/\\"/g;

  $path = `readlink -f "$dir/$base"`;
  chomp $path;

  ###handle absolute path
  $path =~ s/"/\\"/g;

  $dir = `dirname "$path"`;
  chomp $dir;
  $dir =~ s/"/\\"/g;
  $base = `basename "$path"`;
  chomp $base;
  $base =~ s/"/\\"/g;
}

###actually do stuff
if(defined $path and -e "$dir/$base"){
  my $targetDir = `echo -n ~/Desktop/Torrents`;
  system "cp \"$dir/$base\" \"$targetDir/$base\"";
  exec "transmission \"$dir/$base\"";
}else{
  exec 'transmission';
}

