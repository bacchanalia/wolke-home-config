#!/usr/bin/perl
use strict;
use warnings;

my $alarm = '/usr/share/alarm';

my $pulseUser = `ps --no-heading -o user -C pulseaudio`;
chomp $pulseUser;

my $currentUser = `whoami`;
chomp $currentUser;

if($currentUser eq $pulseUser){
  system "term", "mplayer", $alarm;
}elsif($currentUser eq 'root'){
  print "rerunning as pulse user $pulseUser\n";
  system "su", $pulseUser, "-c", "$0 @ARGV";
}
