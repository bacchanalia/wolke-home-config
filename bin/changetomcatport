#!/usr/bin/perl
use strict;
use warnings;

if($#ARGV != 0){
  die "Usage: $0 [PORTNUM]";
}

my $port = $ARGV[0];
if($port !~ /^[0-9]+$/){
	die "Argument must be an integer"
}

my $file_name = '/usr/share/tomcat6/conf/server.xml';

my $content;
{
	local($/, *INFH);
	open INFH, $file_name or die "Error opening $file_name for reading\n";
	$content = <INFH>;
	close INFH;
}

$content =~ s/<Connector port="([0-9]+)"/<Connector port="$port"/;
my $old_port = $1;

open OUTFH, "> $file_name" or die "Error opening $file_name for writing\n";
print OUTFH $content;
close OUTFH;

print "$file_name: set to $port from $old_port\n";

