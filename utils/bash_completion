#!/usr/bin/perl
use strict;
use warnings;

if(`whoami` ne "root\n"){
  print "rerunning as root\n";
  exec "sudo", $0, @ARGV;
}

my $dir = '/etc/bash_completion.d';

my $files = {
  'sudo-aliases' => "complete -F _root_command suod sudp\n",
  'spawn' => "complete -F _root_command spawn spawnex\n",
};

for my $file(keys %$files){
  my $content = $$files{$file};
  open FH, "> $dir/$file" or die "Couldnt open file $dir/$file\n";
  print FH $content;
  close FH;
}
