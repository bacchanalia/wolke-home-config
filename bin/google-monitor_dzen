#!/usr/bin/perl
use strict;
use warnings;

my $SERVER = 'www.google.com';
my $TIMEOUT = 5;

my $arg = shift;
$arg = '' if not defined $arg;

sub isUp($$){
  my $url = shift;
  my $timeout = shift;
  system "ping $url -c 1 -w 5 > /dev/null";
  if($? == 0){
    return 1;
  }else{
    return 0;
  }
}

sub printStatus($$){
  my $url = shift;
  my $timeout = shift;

  system "clear";
  my $status = isUp($url, $timeout);
  print "^bg(black)";
  print $status ? "^fg(blue)gO" : "^fg(red)gX";
  print "^bg()^fg()\n";
  return $status;
}

if($arg eq '-loop'){
  my $count = 0;
  while(1){
    if($count%2 != 0){
      print ".";
    }
    printStatus($SERVER, $TIMEOUT);
    $count++;
    sleep 2;
  }
}else{
  exit printStatus($SERVER, $TIMEOUT);
}
