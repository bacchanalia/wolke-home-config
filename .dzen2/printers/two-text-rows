#!/usr/bin/perl
use strict;
use warnings;

my $top = shift;
$top = '' if not defined $top;
my $bot = shift;
$bot = '' if not defined $bot;
my $height = shift;
$height = 24 if not defined $height;

my $space = $height / 8;
my $mid = $space + int($height / 2);

sub raise($){
  return "^pa(;0)$_[0]";
}
sub lower($){
  return "^pa(;$mid)$_[0]";
}
sub stripMarkup($){
  my $markup = shift;
  $markup =~ s/\^\^/A/gsxi;
  $markup =~ s/\^[a-z]+\([^)]*\)//gsxi;
  return $markup;
}

my $fst;
my $snd;

if(length stripMarkup $top > length stripMarkup $bot){
  $fst = lower($bot);
  $snd = raise($top);
}else{
  $fst = raise($top);
  $snd = lower($bot);
}

print ''
  . '^p(_LOCK_X)'
  . $fst
  . '^ib(1)'
  . '^p(_UNLOCK_X)'
  . $snd
  . '^ib(0)'
  . '^pa()'
  . "\n"
  ;

